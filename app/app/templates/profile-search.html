<ion-view view-title="{{::appName}}">
  <ion-nav-buttons side="right">
    <i class="button button-icon icon ion-ios-chatbubble-outline" ui-sref="menu.chats">
        <unread-chats-badge/>
    </i>
  </ion-nav-buttons>
  <ion-content class="padding" style="padding-top:100px;padding-top:5vw;text-align:center" no-scroll>
  <!-- no-scroll style=""-->

    <style>

      @-webkit-keyframes fade_out_animation {
        0% { -webkit-transform: scale(1); }
        100% { -webkit-transform: scale(2);  opacity: 0;  }
      }

      .imgOverlay{
        position: absolute;
        margin-left: auto;
        margin-right: auto;
        left: 0;
        right: 0;
      }

      .imgCircle{
        width: 150px;
        height: 150px;
        border-radius: 150px;
        -webkit-border-radius: 150px;
        -moz-border-radius: 150px;
      }

      .verticalAlign{
        position: relative;
        top: 50%;
        transform: translateY(-50%);
        width:100%;
        margin:0 auto;
      }

      

      .fade-out {
        animation-name: 'fade_out_animation';
        animation-duration: 2000ms;
        animation-iteration-count: infinite;
        animation-timing-function: linear;
        -webkit-animation-name: 'fade_out_animation';
        -webkit-animation-duration: 2000ms;
        -webkit-animation-iteration-count: infinite;
        -webkit-animation-timing-function: linear;
        -moz-animation-name: 'fade_out_animation';
        -moz-animation-duration: 2000ms;
        -moz-animation-iteration-count: infinite;
        -moz-animation-timing-function: linear;
        transition: opacity 2s
      }
    </style>
<!-- for testing the match dialog
    <button style="position: absolute;bottom:5px" ng-click="openNewMatch()">Match</button>
-->

    <div></div>

    <div ng-if="!profile.enabled" class="text-label" style="padding-top:50px;padding-top:20vw;">
        <div style="font-size: 24px; font-size: 8vw">{{'NOT_DISCOVERABLE' | translate}}</div>

        <div style="font-size: 14px;font-size: 4vw;padding-top: 5px">{{'ENABLE_DISCOVERY_TO_MEET' | translate}}</div>
        <button class="button button-block" ng-click="enableDiscovery()">{{'ENABLE_DISCOVERY' | translate}}</button>
        <br/><br/>
        <div ng-show="!profile.photos.length">
            <br/>
            <div style="font-size: 20px; font-size: 6vw">You don't have a profile picture yet</div>
            <button class="button button-block" ui-sref="^.profile-edit">Edit Profile</button>
        </div>
    </div>

    <div ng-show="profile.enabled" >

        <div class="verticalAlign" ng-show="!profiles" style="padding-top:150px;padding-top:45vw;">
            <img class="imgOverlay fade-out" style="width:150px" src="img/ring.png"></img>
            <img class="photo imgCircle imgOverlay" img-cache ng-src="{{::profilePhoto}}"></img>
            <!-- Finding people near you... -->
        </div>

        <div ng-show="!profiles || profiles.length==0" style="padding-top:150px;padding-top:45vw;">
            <div class="verticalAlign text-label"  ng-show="!profiles">
              {{'FINDING_PEOPLE' | translate}}
            </div>
            <div class="verticalAlign text-label" style="font-size: 16px;font-size: 5.5vw" ng-show="profiles.length == 0">
              {{'NO_ONE_NEW' | translate}}
              <br/>
              <br/>
              <button class="button" ng-click="searchAgain()">{{'SEARCH_AGAIN' | translate}}</button>
            </div>
        </div>


        <td-cards>
          <!-- ng-if="$index >= profiles.length -2" is to display only the top 2 cards in the DOM for performance -->
          <!-- The profiles array is used like a stack, where the last item shows first -->
          <td-card ng-if="$index >= profiles.length - 2" ng-show="profiles" ng-repeat="profile in profiles track by $index"
                   ng-click="viewDetails(profile)"
                   on-destroy="cardDestroyed($index)"
                   on-transition-left="cardTransitionLeft(profile)" on-transition-right="cardTransitionRight(profile)"
                   class="card-{{$index}}" ng-class="{'accepted-transform': profile.accepted, 'rejected-transform': profile.rejected}">
            <div class="image" ng-click="viewDetails(profile)">
              <div class="yes-text" ng-style="leftTextOpacity">{{'LIKE' | translate}}</div>
              <img style="width:100%" ng-src="{{::profile.image}}">
              <div class="no-text" ng-style="rightTextOpacity">{{'NOT_LIKE' | translate}}</div>
            </div>
            <div >
              {{profile.name}}
              <!--
              <div class="button-bar" style="{{profile.hideButtons ? 'display:none' : ''}}">
                <button class="button button-clear button-positive icon ion-ios7-close-empty" ng-click="reject(profile)"></button>
                <button class="button button-clear button-positive icon ion-ios7-heart-outline" ng-click="accept(profile)"></button>
              </div>
              -->
            </div>
          </td-card>
        </td-cards>


        <!--
            Example alternative layouts. The ng-if="searchLayout == 'type'" is not currently wired up.
            Neither is the like reject buttons in the big card layout
        -->

        <!-- For list layout examples see http://ionicframework.com/docs/components/#item-thumbnails -->
        <div class="list" ng-if="searchLayout == 'list'">
            <a class="item item-thumbnail-left" style="text-align: left" ng-repeat="profile in profiles track by $index" ng-click="viewDetails(profile)">
                <img ng-src="{{::profile.image}}" img-cache>
                <h2>{{::profile.name}}, {{::profile.age}}</h2>
                <p>
                    {{profile.location | distance}} {{'AWAY' | translate}}<br/>
                    {{profile.about}}
                </p>
            </a>
        </div>

        <!-- 2xN Grid layout There's a few different way to iterate when fixed columns. Using the approach at http://stackoverflow.com/a/30259461/1052084 -->
        <div class="row" ng-repeat="profile in profiles track by $index" ng-if="searchLayout == 'grid' && $index % 2 == 0">
            <div class="col" >
                <div class="list card" ng-click="viewDetails(profile)">
                    <div class="item item-image"><img ng-src="{{::profile.image}}"></div>
                    <a class="item item-icon-left item-icon-right">{{::profile.name}}</a>
                </div>
            </div>
            <div class="col">
                <div class="list card" ng-click="viewDetails(profiles[index+1])" ng-if="$index+1 < profiles.length">
                    <div class="item item-image"><img ng-src="{{::profile[index+1].image}}"></div>
                    <a class="item item-icon-left item-icon-right">{{::profile[index+1].name}}</a>
                </div>
            </div>
        </div>

        <!-- For card layout examples see http://ionicframework.com/docs/components/#card-images -->
        <div class="list card" ng-repeat="profile in profiles track by $index" ng-if="searchLayout == 'card'" ng-click="viewDetails(profile)">
            <div class="item item-image">
                <img ng-src="{{::profile.image}}">
            </div>
            <a class="item item-icon-left  item-icon-right" href="#">
                <i style="float:left" class="button button-icon icon ion-android-close assertive" ng-click="reject()"></i>
                {{::profile.name}}
                <i style="float:right" class="button button-icon icon ion-ios-heart-outline assertive" ng-click="like()"></i>
            </a>
        </div>

        <div ng-show="profiles.length > 0" class="swipe-buttons">
            <div class="row" >
                <div class="col">
                    <a class="button button-icon" ng-click="reject()">
                        <i class="icon ion-ios-close-outline swipe-button swipe-reject"></i>
                    </a>
                </div>
                <div class="col">
                    <a class="button button-icon" ng-click="accept()">
                        <i class="icon ion-ios-checkmark-outline swipe-button swipe-accept"></i>
                    </a>
                </div>
            </div>
        </div>

    </div>

  </ion-content>
</ion-view>